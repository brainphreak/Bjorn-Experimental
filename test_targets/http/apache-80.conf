<VirtualHost *:80>
    ServerAdmin webmaster@localhost
    DocumentRoot /var/www/html

    # Enable TRACE method
    TraceEnable On

    # Set insecure cookies on every response (triggers http-cookie-flags)
    Header always add Set-Cookie "session_id=abc123def456; path=/"
    Header always add Set-Cookie "auth_token=xyz789; path=/"

    # Directory listing and CGI execution
    <Directory /var/www/html>
        Options +Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    # CGI scripts - handle both .sh and extensionless
    ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/
    <Directory /usr/lib/cgi-bin>
        Options +ExecCGI
        AddHandler cgi-script .sh .cgi
        SetHandler cgi-script
        Require all granted
    </Directory>

    # PHP in CGI mode (triggers CVE-2012-1823 detection)
    Action php-cgi /cgi-bin/php-cgi
    AddHandler php-cgi .php

    # Server status and info pages (http-enum targets)
    <Location /server-status>
        SetHandler server-status
        Require all granted
    </Location>
    <Location /server-info>
        SetHandler server-info
        Require all granted
    </Location>

    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>
